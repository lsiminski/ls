/**
*	Preload Page Plugin
*	Version: 1.0
*	URL: @ThemeMountain
*	Description: Preload images in page. Simplified version of jPreLoader
*	Requires: jQuery 1.10+
*	License: MIT (http://www.opensource.org/licenses/mit-license.php)
*/
!function(e){"use strict";var t=function(t,a,r){a&&e.extend(g,a);var o=e(t).is("[data-loader-type]")?e(t).data("loader-type"):"default";g.showPercentage=e(t).is("[data-show-percentage]")?!0:g.showPercentage,e(t).css({visibility:"visible"}),"function"==typeof r&&(p=r),n()?p():i(t,o)},n=function(){if(g.onetimeLoad){for(var e,t=document.cookie.split("; "),n=0;e=t[n]&&t[n].split("=");n++)if("preloadPage"===e.shift())return e.join("=");return!1}return!1},a=function(e){if(g.onetimeLoad){var t=new Date;t.setDate(t.getDate()+e);var n=null===e?"":"expires="+t.toUTCString();document.cookie="preloadPage=loaded; "+n}},i=function(t,n){var a=e("<div />").attr("class","tm-pageloader-wrapper").css({position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:9999999}).appendTo(t),i=e("<div />").attr("class","tm-pageloader").addClass(n).appendTo(a);if("none"!=n){e("<div />").attr("id","tm-pl-bar").css({width:"0%",height:"100%"}).appendTo(i)}if(g.showPercentage){e("<div />").attr("id","tm-pl-percentage").appendTo(i)}r(t)},r=function(t){e(t).find("*:not(script)").each(function(){var t="";if(-1==e(this).css("background-image").indexOf("none")&&-1==e(this).css("background-image").indexOf("-gradient")){if(t=e(this).css("background-image"),-1!=t.indexOf("url")){var n=t.match(/url\((.*?)\)/);t=n[1].replace(/\"/g,"")}}else"img"==e(this).get(0).nodeName.toLowerCase()&&"undefined"!=typeof e(this).attr("src")&&(t=e(this).attr("src"));t.length>0&&(f.push(t),o(t))})},o=function(t){var n=new Image;e(n).one("error",function(){l.push(e(this).attr("src")),s()}).one("load",function(){s()}).attr("src",t)},s=function(){u++;var t=".tm-pageloader-wrapper",n="#tm-pl-bar",i="#tm-pl-percentage",r=Math.round(u/f.length*100);e(n).stop().animate({width:r+"%"},500,"linear"),g.showPercentage&&e(i).text(r+"%"),u>=f.length&&(u=f.length,a(),g.showPercentage&&e(i).text("100%"),e(n).stop().animate({width:"100%"},1e3,"linear",function(){c(t)}),d())},c=function(t){e(t).delay(100).fadeOut(1e3,function(){e(t).remove(),p()})},d=function(){if(l.length>0){var e;e+=l.length+" image file/s can not be found. \n\r",e+="Please check:\n\r";for(var t=0;t<l.length;t++)e+="- "+l[t]+"\n\r";return console.log(e),!0}return!1},f=[],l=[],u=0,p=function(){},g={showPercentage:!1,onetimeLoad:!1};e.fn.preloadPage=function(e,n){return this.each(function(){new t(this,e,n)})}}(jQuery);